{"ast":null,"code":"import axios from \"axios\";\nimport { ACCESS_TOKEN, SECRET, ADMIN_ID, ADMIN_STRING } from \"../Components/Constants/index.js\";\n\nvar jwt = require(\"jsonwebtoken\");\n\nclass Authenticate {\n  // constructor\n  // methods\n  // DELETE?\n  isLoggedIn() {\n    let token = localStorage.getItem(ACCESS_TOKEN);\n\n    if (token) {\n      // add -> redux, if decodedtoken sub is XXX then make admin, else normal user\n      return true;\n    }\n\n    return false;\n  }\n  /* Function will access the local storage for the access token and return the sub # which is relevant to the user ID */\n\n\n  getUser() {\n    let token = localStorage.getItem(ACCESS_TOKEN);\n    let decode = jwt.verify(token, SECRET); //console.log(decode);\n\n    let user = {\n      userId: decode.sub,\n      userName: decode.name,\n      userAdmin: decode.admin\n    };\n    return user;\n  } // DELETE ?\n\n\n  async isAdmin(userId) {\n    let flag = false; // a return statment was required for the await block.\n\n    if (userId === ADMIN_ID) {\n      return await axios.get(\"/api/users/\".concat(userId)).then(res => {\n        const rolesArray = res.data.roles;\n        rolesArray.forEach(element => {\n          if (element.name === ADMIN_STRING) {\n            flag = true;\n          }\n        });\n        return flag;\n      });\n    } else {\n      return flag;\n    }\n  }\n\n  removeToken() {\n    localStorage.removeItem(ACCESS_TOKEN);\n  }\n\n}\n\nexport default new Authenticate();","map":{"version":3,"sources":["C:\\Users\\Steve\\Documents\\OSU\\Side Projects\\Expenses\\expenses\\app\\src\\Utils\\authenicate.js"],"names":["axios","ACCESS_TOKEN","SECRET","ADMIN_ID","ADMIN_STRING","jwt","require","Authenticate","isLoggedIn","token","localStorage","getItem","getUser","decode","verify","user","userId","sub","userName","name","userAdmin","admin","isAdmin","flag","get","then","res","rolesArray","data","roles","forEach","element","removeToken","removeItem"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACEC,YADF,EAEEC,MAFF,EAGEC,QAHF,EAIEC,YAJF,QAKO,kCALP;;AAMA,IAAIC,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAjB;;AAEA,MAAMC,YAAN,CAAmB;AACjB;AAEA;AACA;AACAC,EAAAA,UAAU,GAAG;AACX,QAAIC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqBV,YAArB,CAAZ;;AACA,QAAIQ,KAAJ,EAAW;AACT;AACA,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD;AAED;;;AACAG,EAAAA,OAAO,GAAG;AACR,QAAIH,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqBV,YAArB,CAAZ;AACA,QAAIY,MAAM,GAAGR,GAAG,CAACS,MAAJ,CAAWL,KAAX,EAAkBP,MAAlB,CAAb,CAFQ,CAGR;;AACA,QAAIa,IAAI,GAAG;AACTC,MAAAA,MAAM,EAAEH,MAAM,CAACI,GADN;AAETC,MAAAA,QAAQ,EAAEL,MAAM,CAACM,IAFR;AAGTC,MAAAA,SAAS,EAAEP,MAAM,CAACQ;AAHT,KAAX;AAKA,WAAON,IAAP;AACD,GAzBgB,CA2BjB;;;AACA,QAAMO,OAAN,CAAcN,MAAd,EAAsB;AACpB,QAAIO,IAAI,GAAG,KAAX,CADoB,CAGpB;;AACA,QAAIP,MAAM,KAAKb,QAAf,EAAyB;AACvB,aAAO,MAAMH,KAAK,CAACwB,GAAN,sBAAwBR,MAAxB,GAAkCS,IAAlC,CAAuCC,GAAG,IAAI;AACzD,cAAMC,UAAU,GAAGD,GAAG,CAACE,IAAJ,CAASC,KAA5B;AACAF,QAAAA,UAAU,CAACG,OAAX,CAAmBC,OAAO,IAAI;AAC5B,cAAIA,OAAO,CAACZ,IAAR,KAAiBf,YAArB,EAAmC;AACjCmB,YAAAA,IAAI,GAAG,IAAP;AACD;AACF,SAJD;AAKA,eAAOA,IAAP;AACD,OARY,CAAb;AASD,KAVD,MAUO;AACL,aAAOA,IAAP;AACD;AACF;;AAEDS,EAAAA,WAAW,GAAG;AACZtB,IAAAA,YAAY,CAACuB,UAAb,CAAwBhC,YAAxB;AACD;;AAjDgB;;AAmDnB,eAAe,IAAIM,YAAJ,EAAf","sourcesContent":["import axios from \"axios\";\r\nimport {\r\n  ACCESS_TOKEN,\r\n  SECRET,\r\n  ADMIN_ID,\r\n  ADMIN_STRING\r\n} from \"../Components/Constants/index.js\";\r\nvar jwt = require(\"jsonwebtoken\");\r\n\r\nclass Authenticate {\r\n  // constructor\r\n\r\n  // methods\r\n  // DELETE?\r\n  isLoggedIn() {\r\n    let token = localStorage.getItem(ACCESS_TOKEN);\r\n    if (token) {\r\n      // add -> redux, if decodedtoken sub is XXX then make admin, else normal user\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /* Function will access the local storage for the access token and return the sub # which is relevant to the user ID */\r\n  getUser() {\r\n    let token = localStorage.getItem(ACCESS_TOKEN);\r\n    let decode = jwt.verify(token, SECRET);\r\n    //console.log(decode);\r\n    let user = {\r\n      userId: decode.sub,\r\n      userName: decode.name,\r\n      userAdmin: decode.admin\r\n    };\r\n    return user;\r\n  }\r\n\r\n  // DELETE ?\r\n  async isAdmin(userId) {\r\n    let flag = false;\r\n\r\n    // a return statment was required for the await block.\r\n    if (userId === ADMIN_ID) {\r\n      return await axios.get(`/api/users/${userId}`).then(res => {\r\n        const rolesArray = res.data.roles;\r\n        rolesArray.forEach(element => {\r\n          if (element.name === ADMIN_STRING) {\r\n            flag = true;\r\n          }\r\n        });\r\n        return flag;\r\n      });\r\n    } else {\r\n      return flag;\r\n    }\r\n  }\r\n\r\n  removeToken() {\r\n    localStorage.removeItem(ACCESS_TOKEN);\r\n  }\r\n}\r\nexport default new Authenticate();\r\n"]},"metadata":{},"sourceType":"module"}